<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>ESP32 传感器历史数据</title>
    <script>
        function fetchHistory(page = 1, per_page = 10) {
            fetch(`http://www.404-notfound.icu:3232/history?page=${page}&per_page=${per_page}`)
                .then(response => response.json())
                .then(data => {
                    let table = document.getElementById("historyTable");
                    table.innerHTML = "<tr><th>时间</th><th>温度 (°C)</th><th>湿度 (%)</th><th>声音</th><th>光照</th><th>空气质量</th><th>PIR</th><th>加速度 (x,y,z)</th></tr>";

                    data.data.forEach(entry => {
                        let row = table.insertRow();
                        row.insertCell(0).innerText = entry.timestamp;
                        row.insertCell(1).innerText = entry.temp;
                        row.insertCell(2).innerText = entry.hum;
                        row.insertCell(3).innerText = entry.sound;
                        row.insertCell(4).innerText = entry.light;
                        row.insertCell(5).innerText = entry.air_quality;
                        row.insertCell(6).innerText = entry.pir;
                        row.insertCell(7).innerText = entry.acc.join(", ");
                    });

                    document.getElementById("page").innerText = `当前页：${data.page}`;
                })
                .catch(error => console.error("获取历史数据失败:", error));
        }
    </script>
</head>
<body onload="fetchHistory()">
    <h1>ESP32 传感器历史数据</h1>
    <table border="1" id="historyTable"></table>
    <p id="page"></p>
    <button onclick="fetchHistory(1, 10)">第一页</button>
    <button onclick="fetchHistory(2, 10)">第二页</button>
</body>
</html>
